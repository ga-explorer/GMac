namespace main.test

open main

macro test1(s1 : scalar, s2 : scalar) : scalar
begin
    let t = s1 * 2
    let s1 = s1 + 5
    let x = s1
    let n = x + 4
    let f = n * 8
    
    return s1 gp s2
end

macro test2(s1 : scalar, s2 : scalar) : scalar
begin
    //let s1 = 'Pi'
    //let s2 = '2 * Pi'
    let t = s1 + s2
    let k = t - 5
    let s = s1 + s2
    let m = s - 5
    
    return k * m
end

//Test SSA form on lhs partial value access operations
macro test3(mv1 : cga5d.Multivector) : scalar
begin
    let t1 = -mv1
    let t1.#E5# = t1.#E0# * 2
    let t2 = t1 gp t1
    let t1.#E2# = t1 sp t1
    let t3 = t1 gp t2
    
    return t3.#E0#
end

macro test4(mv1 : cga5d.Multivector, mv2 : cga5d.Multivector) : cga5d.Multivector
begin
    return mv1 gp mv2
end

/*
namespace main.target

open main

access array
begin
   csharp '#name#[#member#]'
   //vbnet  '#name#(#member#)'
end

access object
begin
   csharp '#name#.#member#'
   //vbnet  '#name#.#member#'
end

binding cga5d_binding on cga5d
begin
    bind var.#E0# to constant 1
    bind var.@G1@ to '#index#' //#name#, #id#, #grade#, #index#, #gadim#, #vdim#, #kvdim#
    bind var.@G2@ to 'kvector#grade#_#index#'
    bind var.@G3@ to 'coef#id#' 
    bind var.#E31# to '_scalar'
end

binding ray_binding on main.conformal.twist.Ray
begin
    bind var.pos.@e1,e2,e3@ to 'Origin_#member#' with cga5d_binding
    bind var.dir.@e1,e2,e3@ to 'Direction_#member#' with cga5d_binding
end

binding vector3D_binding on main.cga5d
begin
    bind var.#e1# to 'x'
    bind var.#e2# to 'y'
    bind var.#e3# to 'z'
end

binding ApplyUnitInvTSRToRay3D_binding on main.conformal.twist.ApplyUnitInvTSRToRay3D
begin
    bind scale_factor to 's'
    bind tr_vec to object('TrVector') with vector3D_binding
    bind rot_axis to object('RotationAxis') with vector3D_binding
    bind angle to 'RotationAngle'
    bind in_pos to 'Ray.Origin_#member#' with vector3D_binding
    bind in_dir to 'Ray.Direction_#member#' with vector3D_binding
    bind result to object('OutputRay') with ray_binding
end
*/
